---
author: memildin
ms.service: defender-for-cloud
ms.topic: include
ms.date: 01/12/2022
ms.author: memildin
ms.custom: generated
---

There are **46** AWS recommendations in this category.

|Recommendation |Description |Severity |
|---|---|---|
|[Amazon Elasticsearch Service domains should be in a VPC](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/df952171-786d-44b5-b309-9c982bddeb7c) |VPC cannot contain domains with a public endpoint. <br>Note: this does not evaluate the VPC subnet routing configuration to determine public reachability. |High |
|[Amazon S3 permissions granted to other AWS accounts in bucket policies should be restricted](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/de8ae504-ec39-4ffb-b3ef-6e36fdcbb455) |Implementing least privilege access is fundamental to reducing security risk and the impact of errors or malicious intent. If an S3 bucket policy allows access from external accounts, it could result in data exfiltration by an insider threat or an attacker. The 'blacklistedactionpatterns' parameter allows for successful evaluation of the rule for S3 buckets. The parameter grants access to external accounts for action patterns that are not included in the 'blacklistedactionpatterns' list. |High |
|[Avoid the use of the "root" account](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/a47a6c3b-0629-406c-ad09-d91f7d9f78a3) |The "root" account has unrestricted access to all resources in the AWS account. It is highly recommend that the use of this account be avoided.<br>The "root" account is the most privileged AWS account. Minimizing the use of this account and adopting the principle of least privilege for access management will reduce the risk of accidental changes and unintended disclosure of highly privileged credentials. |High |
|[AWS KMS keys should not be unintentionally deleted](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/10c59743-84c4-4711-adb7-ba895dc57339) |This control checks whether KMS keys are scheduled for deletion. The control fails if a KMS key is scheduled for deletion.<br>KMS keys cannot be recovered once deleted. Data encrypted under a KMS key is also permanently unrecoverable if the KMS key is deleted. If meaningful data has been encrypted under a KMS key scheduled for deletion, consider decrypting the data or re-encrypting the data under a new KMS key unless you are intentionally performing a cryptographic erasure.<br>When a KMS key is scheduled for deletion, a mandatory waiting period is enforced to allow time to reverse the deletion, if it was scheduled in error. The default waiting period is 30 days, but it can be reduced to as short as 7 days when the KMS key is scheduled for deletion. During the waiting period, the scheduled deletion can be canceled and the KMS key will not be deleted.<br>For additional information regarding deleting KMS keys, see <a href='https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html'>Deleting KMS keys</a> in the AWS Key Management Service Developer Guide. |High |
|[AWS WAF Classic global web ACL logging should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/ad593449-a095-47b5-91b8-894396a1aa7f) |This control checks whether logging is enabled for an AWS WAF global Web ACL. This control fails if logging is not enabled for the web ACL.<br>Logging is an important part of maintaining the reliability, availability, and performance of AWS WAF globally. It is a business and compliance requirement in many organizations, and allows you to troubleshoot application behavior. It also provides detailed information about the traffic that is analyzed by the web ACL that is attached to AWS WAF. |Medium |
|[CloudFront distributions should have a default root object configured](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/186509dc-f326-415f-b085-4d27f1342849) |This control checks whether an Amazon CloudFront distribution is configured to return a specific object that is the default root object. The control fails if the CloudFront distribution does not have a default root object configured.<br>A user might sometimes request the distributions root URL instead of an object in the distribution. When this happens, specifying a default root object can help you to avoid exposing the contents of your web distribution. |High |
|[CloudFront distributions should have origin access identity enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/a0ab1f4e-bafb-4947-a7d1-13a9c35c7d82) |This control checks whether an Amazon CloudFront distribution with Amazon S3 Origin type has Origin Access Identity (OAI) configured. The control fails if OAI is not configured.<br>CloudFront OAI prevents users from accessing S3 bucket content directly. When users access an S3 bucket directly, they effectively bypass the CloudFront distribution and any permissions that are applied to the underlying S3 bucket content. |Medium |
|[CloudTrail log file validation should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/324ec96c-9719-46ce-b6a9-e7f4fed7dd6e) |To ensure additional integrity checking of CloudTrail logs, we recommend enabling file validation on all CloudTrails. |Low |
|[CloudTrail should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/2917bcec-6991-4ea4-9e73-156e6ef831e4) |AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. Not all services enable logging by default for all APIs and events. <br> You should implement any additional audit trails other than CloudTrail and review the documentation for each service in CloudTrail Supported Services and Integrations. |High |
|[CloudTrail trails should be integrated with CloudWatch Logs](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/842be2e5-2cd8-420f-969a-6d6b4096c580) |In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, real-time analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. <br> For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. We recommended that CloudTrail logs will be sent to CloudWatch Logs to ensure AWS account activity is being captured, monitored, and appropriately alarmed on. <br>Sending CloudTrail logs to CloudWatch Logs facilitates real-time and historic activity logging based on user, API, resource, and IP address, and provides opportunity to establish alarms and notifications for anomalous or sensitivity account activity. |Low |
|[Database logging should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/678b2afa-7fc7-45e5-ad4e-2c49efb57ac8) |This control checks whether the following logs of Amazon RDS are enabled and sent to CloudWatch Logs:<br>- Oracle: (Alert, Audit, Trace, Listener)<br>- PostgreSQL: (Postgresql, Upgrade)<br>- MySQL: (Audit, Error, General, SlowQuery)<br>- MariaDB: (Audit, Error, General, SlowQuery)<br>- SQL Server: (Error, Agent)<br>- Aurora: (Audit, Error, General, SlowQuery)<br>- Aurora-MySQL: (Audit, Error, General, SlowQuery)<br>- Aurora-PostgreSQL: (Postgresql, Upgrade).<br>RDS databases should have relevant logs enabled. Database logging provides detailed records of requests made to RDS. Database logs can assist with security and access audits and can help to diagnose availability issues. |Medium |
|[Disable direct internet access for Amazon SageMaker notebook instances](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/0991c64b-ccf5-4408-aee9-2ef03d460020) |Direct internet access should be disabled for an SageMaker notebook instance. <br> This checks whether the 'DirectInternetAccess' field is disabled for the notebook instance. <br> Your instance should be configured with a VPC and the default setting should be Disable - Access the internet through a VPC. <br> In order to enable internet access to train or host models from a notebook, make sure that your VPC has a NAT gateway and your security group allows outbound connections. Ensure access to your SageMaker configuration is limited to only authorized users, and restrict users' IAM permissions to modify SageMaker settings and resources. |High |
|[Do not setup access keys during initial user setup for all IAM users that have a console password](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/655f9340-184f-4b6e-8214-b835003ab0b1) |AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. <br> In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. <br> Requiring that additional steps be taken by the user after their profile has been created will give a stronger indication of intent that access keys are [a] necessary for their work and [b] once the access key is established on an account that the keys may be in use somewhere in the organization |Medium |
|[Ensure a support role has been created to manage incidents with AWS Support](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/6614c30d-c9f3-4acd-8371-c8f362148398) |AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. <br> Create an IAM Role to allow authorized users to manage incidents with AWS Support.<br>By implementing least privilege for access control, an IAM Role will require an appropriate IAM Policy to allow Support Center Access in order to manage Incidents with AWS Support. |Low |
|[Ensure access keys are rotated every 90 days or less](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/d72f547e-c011-4cdb-9dda-8c4d6dc09bf2) |Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. <br> AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. <br> It is recommended that all access keys be regularly rotated. <br> Rotating access keys will reduce the window of opportunity for an access key that is associated with a compromised or terminated account to be used. <br> Access keys should be rotated to ensure that data cannot be accessed with an old key which might have been lost, cracked, or stolen. |Medium |
|[Ensure AWS Config is enabled in all regions](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/3ff06f36-f8fd-4af5-bd02-5195593423fb) |AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. <br> The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. <br>It is recommended to enable AWS Config be enabled in all regions. <br><br>The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. |Medium |
|[Ensure CloudTrail is enabled in all regions](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/b3d8e09b-83a6-417a-ae1e-3f5b54576965) |AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. <br> The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation). <br>The AWS API call history produced by CloudTrail enables security analysis, resource change tracking, and compliance auditing. Additionally, <br> * ensuring that a multi-regions trail exists will ensure that unexpected activity occurring in otherwise unused regions is detected <br>* ensuring that a multi-regions trail exists will ensure that "Global Service Logging" is enabled for a trail by default to capture recording of events generated on AWS global services <br>* for a multi-regions trail, ensuring that management events configured for all type of Read/Writes ensures recording of management operations that are performed on all resources in an AWS account. |High |
|[Ensure credentials unused for 90 days or greater are disabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/f13dc885-79aa-456b-ba28-3428147ecf55) |AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. <br> It is recommended that all credentials that have been unused in 90 or greater days be removed or deactivated.<br> Disabling or removing unnecessary credentials will reduce the window of opportunity for credentials associated with a compromised or abandoned account to be used. |Medium |
|[Ensure IAM password policy expires passwords within 90 days or less](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/729c20d1-fe7c-4e1b-8c9c-ab5ad56d7f96) |IAM password policies can require passwords to be rotated or expired after a given number of days. <br> It is recommended that the password policy expire passwords after 90 days or less. <br> Reducing the password lifetime increases account resiliency against brute force login attempts. Additionally, requiring regular password changes help in the following scenarios: <br> * Passwords can be stolen or compromised sometimes without your knowledge. This can happen via a system compromise, software vulnerability, or internal threat. <br>* Certain corporate and government web filters or proxy servers have the ability to intercept and record traffic even if it's encrypted. <br>* Many people use the same password for many systems such as work, email, and personal. <br>* Compromised end user workstations might have a keystroke logger. |Low |
|[Ensure IAM password policy prevents password reuse](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/22e99393-671c-4979-a08a-cd1533da9ece) |IAM password policies can prevent the reuse of a given password by the same user. <br>It is recommended that the password policy prevent the reuse of passwords. <br> Preventing password reuse increases account resiliency against brute force login attempts. |Low |
|[Ensure IAM password policy requires at least one lowercase letter](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1c420241-9bec-4af8-afb7-038a711b7d22) |Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one lowercase letter. <br>Setting a password complexity policy increases account resiliency against brute force login attempts |Medium |
|[Ensure IAM password policy requires at least one number](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/84fb0ae8-4785-449c-b9ac-e106a2509540) |Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one number. <br> Setting a password complexity policy increases account resiliency against brute force login attempts. |Medium |
|[Ensure IAM password policy requires at least one symbol](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1919c309-1c8b-4fab-bd8c-7ff77521db40) |Password policies are, in part, used to enforce password complexity requirements. <br> IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one symbol.<br> Setting a password complexity policy increases account resiliency against brute force login attempts. |Medium |
|[Ensure IAM password policy requires at least one uppercase letter](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/6e5ebe18-e026-4c26-875c-fcbea8089071) |Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one uppercase letter. <br> Setting a password complexity policy increases account resiliency against brute force login attempts. |Medium |
|[Ensure IAM password policy requires minimum length of 14 or greater](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/e109af9f-128b-4774-a40c-aab8eff3934c) |Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. <br>It is recommended that the password policy require a minimum password length '14'. <br> Setting a password complexity policy increases account resiliency against brute force login attempts. |Medium |
|[Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/b73d3c97-01e1-43b4-bf01-a459e5eed3de) |Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password.<br> With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. <br> It is recommended that MFA be enabled for all accounts that have a console password.<br>Enabling MFA provides increased security for console access as it requires the authenticating principal to possess a device that emits a time-sensitive key and have knowledge of a credential. |Medium |
|[GuardDuty should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/4b32e0a4-44a7-4f18-ad92-549f7d219061) |To provide additional protection against intrusions, GuardDuty should be enabled on your AWS account and region. <br> Note: GuardDuty might not be a complete solution for every environment |Medium |
|[Hardware MFA should be enabled for the "root" account](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/eb39e935-38fc-4b0c-8cf2-d6affab0306a) |The root account is the most privileged user in an account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they're prompted for their user name and password and for an authentication code from their AWS MFA device.<br> For Level 2, it is recommended that you protect the root account with a hardware MFA. A hardware MFA has a smaller attack surface than a virtual MFA. For example, a hardware MFA doesn't suffer the attack surface introduced by the mobile smartphone that a virtual MFA resides on. <br> Using hardware MFA for many, many accounts might create a logistical device management issue. If this occurs, consider implementing this Level 2 recommendation selectively to the highest security accounts. You can then apply the Level 1 recommendation to the remaining accounts. |Low |
|[IAM authentication should be configured for RDS clusters](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/3ac30502-52e5-4fc6-af40-095dddfbc8b9) |This control checks whether an RDS DB cluster has IAM database authentication enabled.<br>IAM database authentication allows for password-free authentication to database instances. The authentication uses an authentication token. Network traffic to and from the database is encrypted using SSL. For more information, see IAM database authentication in the Amazon Aurora User Guide. |Medium |
|[IAM authentication should be configured for RDS instances](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/cd307f02-2ca7-44b4-8c1b-b580251d613c) |This control checks whether an RDS DB instance has IAM database authentication enabled.<br>IAM database authentication allows authentication to database instances with an authentication token instead of a password. Network traffic to and from the database is encrypted using SSL. For more information, see IAM database authentication in the Amazon Aurora User Guide. |Medium |
|[IAM customer managed policies should not allow decryption actions on all KMS keys](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/d088fb9f-11dc-451e-8f79-393916e42bb2) |Checks whether the default version of IAM customer managed policies allow principals to use the AWS KMS decryption actions on all resources. This control uses <a href='http://aws.amazon.com/blogs/security/protect-sensitive-data-in-the-cloud-with-automated-reasoning-zelkova'>Zelkova</a>, an automated reasoning engine, to validate and warn you about policies that may grant broad access to your secrets across AWS accounts.This control fails if the "kms:Decrypt" or "kms:ReEncryptFrom" actions are allowed on all KMS keys. The control evaluates both attached and unattached customer managed policies. It does not check inline policies or AWS managed policies.<br />With AWS KMS, you control who can use your KMS keys and gain access to your encrypted data. IAM policies define which actions an identity (user, group, or role) can perform on which resources. Following security best practices, AWS recommends that you allow least privilege. In other words, you should grant to identities only the "kms:Decrypt" or "kms:ReEncryptFrom" permissions and only for the keys that are required to perform a task. Otherwise, the user might use keys that are not appropriate for your data.<br />Instead of granting permissions for all keys, determine the minimum set of keys that users need to access encrypted data. Then design policies that allow users to use only those keys. For example, do not allow "kms:Decrypt" permission on all KMS keys. Instead, allow "kms:Decrypt" only on keys in a particular Region for your account. By adopting the principle of least privilege, you can reduce the risk of unintended disclosure of your data. |Medium |
|[IAM customer managed policies that you create should not allow wildcard actions for services](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/5a0476c5-a14b-4195-8c31-633511234b38) |This control checks whether the IAM identity-based policies that you create have Allow statements that use the * wildcard to  grant permissions for all actions on any service. The control fails if any policy statement includes 'Effect': 'Allow' with 'Action': 'Service:*'. <br> For example, the following statement in a policy results in a failed finding.<br><code>'Statement': [<br>{<br>  'Sid': 'EC2-Wildcard',<br>  'Effect': 'Allow',<br>  'Action': 'ec2:*',<br>  'Resource': '*'<br>}</code><br> The control also fails if you use 'Effect': 'Allow' with 'NotAction': 'service:*'. In that case, the NotAction element provides access to all of the actions in an AWS service, except for the actions specified in NotAction.<br>This control only applies to customer managed IAM policies. It does not apply to IAM policies that are managed by AWS.<br> When you assign permissions to AWS services, it is important to scope the allowed IAM actions in your IAM policies. You should restrict IAM actions to only those actions that are needed. This helps you to provision least privilege permissions. Overly permissive policies might lead to privilege escalation if the policies are attached to an IAM principal that might not require the permission.<br>In some cases, you might want to allow IAM actions that have a similar prefix, such as DescribeFlowLogs and DescribeAvailabilityZones. In these authorized cases, you can add a suffixed wildcard to the common prefix. For example, ec2:Describe*.<br><br>This control passes if you use a prefixed IAM action with a suffixed wildcard. For example, the following statement in a policy results in a passed finding.<br><code> 'Statement': [<br>{<br>  'Sid': 'EC2-Wildcard',<br>  'Effect': 'Allow',<br>  'Action': 'ec2:Describe*',<br>  'Resource': '*'<br>}</code><br>When you group related IAM actions in this way, you can also avoid exceeding the IAM policy size limits. |Low |
|[IAM policies should be attached only to groups or roles](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/a773f81a-0b2d-4f8e-826a-77fc432416c3) |By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. <br> It is recommended that IAM policies be applied directly to groups and roles but not users.<br>Assigning privileges at the group or role level reduces the complexity of access management as the number of users grow. <br> Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges. |Low |
|[IAM policies that allow full "*:*" administrative privileges should not be created](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1d08b362-7e24-46b0-bed1-4a6c1d1526a5) |IAM policies are the means by which privileges are granted to users, groups, or roles. <br> It is recommended and considered a standard security advice to grant least privilege-that is, granting only the permissions required to perform a task. <br> Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges. <br> It's more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. <br> Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.<br> IAM policies that have a statement with "Effect": "Allow" with "Action": "*" over "Resource": "*" should be removed. |High |
|[IAM principals should not have IAM inline policies that allow decryption actions on all KMS keys](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/18be55d0-b681-4693-af8d-b8815518d758) |Checks whether the inline policies that are embedded in your IAM identities (role, user, or group) allow the AWS KMS decryption actions on all KMS keys. This control uses <a href='http://aws.amazon.com/blogs/security/protect-sensitive-data-in-the-cloud-with-automated-reasoning-zelkova'>Zelkova</a>, an automated reasoning engine, to validate and warn you about policies that may grant broad access to your secrets across AWS accounts. <br>This control fails if "kms:Decrypt" or "kms:ReEncryptFrom" actions are allowed on all KMS keys in an inline policy.<br>With AWS KMS, you control who can use your KMS keys and gain access to your encrypted data. IAM policies define which actions an identity (user, group, or role) can perform on which resources. Following security best practices, AWS recommends that you allow least privilege. In other words, you should grant to identities only the permissions they need and only for keys that are required to perform a task. Otherwise, the user might use keys that are not appropriate for your data.<br>Instead of granting permission for all keys, determine the minimum set of keys that users need to access encrypted data. Then design policies that allow the users to use only those keys. For example, do not allow "kms:Decrypt" permission on all KMS keys. Instead, allow them only on keys in a particular Region for your account. By adopting the principle of least privilege, you can reduce the risk of unintended disclosure of your data. |Medium |
|[Lambda functions should restrict public access](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/64b236a0-f9d7-454a-942a-8c2ba3943cf7) |Lambda function resource-based policy should restrict public access. This recommendation does not check access by internal principals. <br> Ensure access to the function is restricted to authorized principals only by using least privilege resource-based policies. |High |
|[MFA should be enabled for all IAM users](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/9c676d6f-60cb-4c7b-a484-17164c598016) |All IAM users should have multi-factor authentication (MFA) enabled. |Medium |
|[MFA should be enabled for the "root" account](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1c9ea4ef-3bb5-4f02-b8b9-55e788e1a21a) |The root account is the most privileged user in an account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they're prompted for their user name and password and for an authentication code from their AWS MFA device.<br> When you use virtual MFA for root accounts, it is recommended that the device used is not a personal device. Instead, use a dedicated mobile device (tablet or phone) that you manage to keep charged and secured independent of any individual personal devices. <br> This lessens the risks of losing access to the MFA due to device loss, device trade-in, or if the individual owning the device is no longer employed at the company. |Low |
|[Password policies for IAM users should have strong configurations](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/fd751d04-8378-4cf8-8f1b-594ee340ae08) |Checks whether the account password policy for IAM users uses the following minimum configurations.<br> * RequireUppercaseCharacters- Require at least one uppercase character in password. (Default = true)<br>* RequireLowercaseCharacters- Require at least one lowercase character in password. (Default = true)<br>* RequireNumbers- Require at least one number in password. (Default = true) <br>* MinimumPasswordLength- Password minimum length. (Default = 7 or longer)<br> * PasswordReusePrevention- Number of passwords before allowing reuse. (Default = 4) <br> * MaxPasswordAge- Number of days before password expiration. (Default = 90) |Medium |
|[Root account access key shouldn't exist](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/412835f5-0339-4180-9c22-ea8735dc6c24) |The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. <br> It is recommended that all access keys associated with the root account be removed. <br> Removing access keys associated with the root account limits vectors by which the account can be compromised. <br> Additionally, removing the root access keys encourages the creation and use of role based accounts that are least privileged. |High |
|[S3 Block Public Access setting should be enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/ac66d910-ae29-4cab-967b-c3f0810b7642) |Enabling Block Public Access setting for your S3 bucket can help prevent sensitive data leaks and protect your bucket from malicious actions. |Medium |
|[S3 Block Public Access setting should be enabled at the bucket level](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/83f16376-e2dd-487d-b5ee-ba67fef4c5c0) |This control checks whether S3 buckets have bucket-level public access blocks applied. This control fails is if any of the following settings are set to false:<br>* ignorePublicAcls<br>* blockPublicPolicy<br>* blockPublicAcls<br>* restrictPublicBuckets<br>Block Public Access at the S3 bucket level provides controls to ensure that objects never have public access. Public access is granted to buckets and objects through access control lists (ACLs), bucket policies, or both.<br>Unless you intend to have your S3 buckets publicly accessible, you should configure the bucket level Amazon S3 Block Public Access feature. |High |
|[S3 buckets public read access should be removed](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/f65de27c-1b77-4a2d-bc89-8631ff9ee786) |Removing public read access to your S3 bucket can help protect your data and prevent a data breach. |High |
|[S3 buckets public write access should be removed](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/994d14f1-b8d7-4cb3-ad4e-a7ccb08065d5) |Allowing public write access to your S3 bucket can leave you vulnerable to malicious actions such as storing data at your expense, encrypting your files for ransom, or using your bucket to operate malware. |High |
|[Secrets Manager secrets should have automatic rotation enabled](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/4aa0f6dc-40be-43b2-92f1-3a52ad9d68d1) |This control checks whether a secret stored in AWS Secrets Manager is configured with automatic rotation.<br>Secrets Manager helps you improve the security posture of your organization. Secrets include database credentials, passwords, and third-party API keys. You can use Secrets Manager to store secrets centrally, encrypt secrets automatically, control access to secrets, and rotate secrets safely and automatically.<br>Secrets Manager can rotate secrets. You can use rotation to replace long-term secrets with short-term ones. Rotating your secrets limits how long an unauthorized user can use a compromised secret. For this reason, you should rotate your secrets frequently. To learn more about rotation, see <a href='https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html'>Rotating your AWS Secrets Manager secrets</a> in the AWS Secrets Manager User Guide. |Medium |
|[Stopped EC2 instances should be removed after a specified time period](https://portal.azure.com/#blade/Microsoft_Azure_Security/RecommendationsBlade/assessmentKey/1a3340b3-8916-40fe-942d-a937e60f5d4c) |This control checks whether any EC2 instances have been stopped for more than the allowed number of days. An EC2 instance fails this check if it is stopped for longer than the maximum allowed time period, which by default is 30 days. <br> A failed finding indicates that an EC2 instance has not run for a significant period of time. This creates a security risk because the EC2 instance is not being actively maintained (analyzed, patched, updated). If it is later launched, the lack of proper maintenance could result in unexpected issues in your AWS environment. To safely maintain an EC2 instance over time in a nonrunning state, start it periodically for maintenance and then stop it after maintenance. Ideally this is an automated process. |Medium |
|||
